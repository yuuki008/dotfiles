# tmux設定ファイル

# プレフィックスキーの設定
# デフォルトのC-bを解除して、C-tに変更
unbind C-b
set-option -g prefix C-t
set-option -g repeat-time 0

#### キーバインディング設定

# Viモードを有効化（コピーモードでVimキーバインドを使用）
set-window-option -g mode-keys vi

# コピーモードで 'y' キーを押したときに選択したテキストをシステムクリップボードにコピーする設定
# macOSでtmux内からシステムクリップボードにアクセスするには reattach-to-user-namespace が必要
# 'copy-mode-vi' キーバインディングに 'y' キーをバインド
# send-keys -X copy-pipe-and-cancel: コピーパイプを実行し、選択をキャンセルするコマンド
# 'reattach-to-user-namespace pbcopy': 選択したテキストを pbcopy を使ってシステムクリップボードに送る
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

#bind t send-key C-t

# 設定ファイルをリロード
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# カレントディレクトリで開く（macOS用）
bind o run-shell "open #{page_current_page}"

# アクティブペイン以外を全て閉じる
bind -r e kill-pane -a

# Vim風のペイン移動（hjklキー）
bind -r k select-pane -U  # 上に移動
bind -r j select-pane -D  # 下に移動
bind -r h select-pane -L  # 左に移動
bind -r l select-pane -R  # 右に移動

# ウィンドウの順序を入れ替え
bind-key -n C-S-Left swap-window -t -1 \; previous-window   # 左に移動
bind-key -n C-S-Right swap-window -t +1 \; next-window      # 右に移動

# ペインのリサイズ（5行/列ずつ）
bind -r C-k resize-pane -U 5  # 上に拡大
bind -r C-j resize-pane -D 5  # 下に拡大
bind -r C-h resize-pane -L 5  # 左に拡大
bind -r C-l resize-pane -R 5  # 右に拡大

#### 基本設定

# ステータスバーの配置（左寄せ）
set-option -g status-justify "left"
#set-option utf8-default on
#set-option -g mouse-select-pane

# Viモードを有効化
set-window-option -g mode-keys vi
#set-window-option -g utf8 on

# 外観設定
set-option -g status-fg cyan                            # ステータスバーの文字色
set-option -g status-bg black                           # ステータスバーの背景色
set -g pane-active-border-style fg=colour166,bg=default # アクティブペインの枠線色
set -g window-style fg=colour10,bg=default              # 非アクティブウィンドウのスタイル
set -g window-active-style fg=colour12,bg=default       # アクティブウィンドウのスタイル
set-option -g history-limit 64096                       # スクロールバックバッファのサイズ

# Escapeキーの遅延を短縮（10ms）
set -sg escape-time 10

#### カラー設定

# ステータスバーのデフォルトカラー
set-option -g status-style bg=colour235,fg=colour136,default

# 非アクティブウィンドウのタイトル色
set-window-option -g window-status-style fg=colour244,bg=colour234,dim

# アクティブウィンドウのタイトル色
set-window-option -g window-status-current-style fg=colour166,bg=default,bright

# ペインの枠線色
set-option -g pane-border-style fg=colour235 #base02
set-option -g pane-active-border-style fg=colour136,bg=colour235

# メッセージテキストの色
set-option -g message-style bg=colour235,fg=colour166

# ペイン番号表示の色
set-option -g display-panes-active-colour colour33  # アクティブ: 青
set-option -g display-panes-colour colour166        # 非アクティブ: オレンジ

# 時計の色
set-window-option -g clock-mode-colour colour64 # 緑

# タイトルバーを接続先ホストに応じて変更
set -g set-titles on
set -g set-titles-string "#T"

# macOS固有の設定を読み込み
if-shell "uname -s | grep -q Darwin" "source ~/.tmux.conf.osx"

# Powerlineステータスバー設定を読み込み
source ~/.tmux.powerline.conf
